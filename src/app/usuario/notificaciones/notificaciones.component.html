<!-- Overlay de fondo -->
<div class="notificaciones-overlay" *ngIf="isOpen" (click)="cerrarPanel()"></div>

<!-- Panel de notificaciones -->
<div class="notificaciones-panel" [class.open]="isOpen">
  <!-- Bot贸n flecha para cerrar -->
  <button class="btn-flecha-cerrar" (click)="cerrarPanel()" title="Cerrar y volver al men煤">
    <i class="bi bi-chevron-left"></i>
  </button>

  <!-- Header -->
  <div class="notificaciones-header">
    <h2 class="titulo">Actualizaciones</h2>
    
    <div class="header-actions">
      <button class="btn-cerrar" (click)="cerrarPanel()" title="Cerrar">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <button 
        class="btn-marcar-todas"
        (click)="marcarTodasComoLeidas()"
        *ngIf="notificacionesNoLeidas > 0">
        Marcar todas como le铆das
      </button>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filtros">
    <button 
      class="filtro-btn"
      [class.activo]="filtroActual === 'todas'"
      (click)="cambiarFiltro('todas')">
      Todas
      <span class="badge">{{ notificaciones.length }}</span>
    </button>
    <button 
      class="filtro-btn"
      [class.activo]="filtroActual === 'noLeidas'"
      (click)="cambiarFiltro('noLeidas')">
      No le铆das
      <span class="badge" *ngIf="notificacionesNoLeidas > 0">{{ notificacionesNoLeidas }}</span>
    </button>
  </div>

  <!-- Lista de notificaciones -->
  <div class="notificaciones-lista">
    <div 
      *ngFor="let notificacion of notificacionesFiltradas"
      class="notificacion-item"
      [class.no-leida]="!notificacion.leida"
      (click)="marcarComoLeida(notificacion)">
      
      <!-- Avatar del usuario -->
      <div class="notificacion-avatar">
        <img [src]="notificacion.usuarioEmisor.avatar" [alt]="notificacion.usuarioEmisor.nombre">
        <span class="icono-tipo">{{ obtenerIcono(notificacion.tipo) }}</span>
      </div>

      <!-- Contenido de la notificaci贸n -->
      <div class="notificacion-contenido">
        <div class="notificacion-texto">
          <span class="usuario-nombre">{{ notificacion.usuarioEmisor.nombre }}</span>
          <span class="mensaje">{{ notificacion.mensaje }}</span>
        </div>
        <span class="notificacion-tiempo">{{ obtenerTiempoTranscurrido(notificacion.fecha) }}</span>
      </div>

      <!-- Imagen de la publicaci贸n (si existe) -->
      <div class="notificacion-imagen" *ngIf="notificacion.imagen">
        <img [src]="notificacion.imagen" alt="Imagen de publicaci贸n">
      </div>

      <!-- Bot贸n eliminar -->
      <button 
        class="btn-eliminar"
        (click)="eliminarNotificacion($event, notificacion.id)"
        title="Eliminar notificaci贸n">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>

      <!-- Indicador de no le铆da -->
      <div class="indicador-no-leida" *ngIf="!notificacion.leida"></div>
    </div>

    <!-- Mensaje cuando no hay notificaciones -->
    <div class="sin-notificaciones" *ngIf="notificacionesFiltradas.length === 0">
      <div class="sin-notificaciones-icono"></div>
      <p class="sin-notificaciones-texto">
        {{ filtroActual === 'noLeidas' ? 'No tienes notificaciones sin leer' : 'No tienes notificaciones' }}
      </p>
    </div>
  </div>
</div>

